# 2025å¹´7æœˆ9æ—¥ VS Codeæ‹¡å¼µæ©Ÿèƒ½ä¿®æ­£è¨˜éŒ²ï¼ˆå®Œå…¨ç‰ˆï¼‰

## ğŸ“‹ ä½œæ¥­æ¦‚è¦
Claude Codeä½¿ç”¨é‡ç›£è¦–æ‹¡å¼µæ©Ÿèƒ½ã®è¡¨ç¤ºå•é¡Œã‚’ä¿®æ­£ã—ã€æ—¥æœ¬æ™‚é–“å¯¾å¿œã¨MAXãƒ—ãƒ©ãƒ³è¡¨ç¤ºã‚’æ”¹å–„ã™ã‚‹åŒ…æ‹¬çš„ãªä¿®æ­£ä½œæ¥­ã‚’å®Ÿæ–½

## ğŸš¨ ç™ºç”Ÿã—ãŸå•é¡Œ

### 1. MAXãƒ—ãƒ©ãƒ³è¡¨ç¤ºå•é¡Œ
- **ç¾è±¡**: æ‹¡å¼µæ©Ÿèƒ½ãŒ"Pro"ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ãŸãŒã€å®Ÿéš›ã¯MAXãƒ—ãƒ©ãƒ³ã‚’ä½¿ç”¨
- **åŸå› **: ccusageã®å‡ºåŠ›ã«ãƒ—ãƒ©ãƒ³åãŒæ˜ç¤ºçš„ã«å«ã¾ã‚Œã¦ã„ãªã„
- **å½±éŸ¿**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªåˆ†ã®ãƒ—ãƒ©ãƒ³ã‚’æ­£ã—ãèªè­˜ã§ããªã„

### 2. æ™‚åˆ»è¡¨ç¤ºã®ä¸æ•´åˆ
- **ç¾è±¡**: æ—¥æœ¬æ™‚é–“12:13 PMãªã®ã«ã€æ‹¡å¼µæ©Ÿèƒ½ãŒ01:00:00 AMãªã©ã®å¤ã„æ™‚åˆ»ã‚’è¡¨ç¤º
- **åŸå› **: ccusageãŒUTCæ™‚åˆ»ã§å‡ºåŠ›ã™ã‚‹ãŒã€æ‹¡å¼µæ©Ÿèƒ½ãŒæ—¥æœ¬æ™‚é–“ã«å¤‰æ›ã—ã¦ã„ãªã„
- **å½±éŸ¿**: ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚åˆ»ã®æŠŠæ¡ãŒå›°é›£

### 3. ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ã®ä¸è¶³
- **ç¾è±¡**: ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚åˆ»ã®ã¿è¡¨ç¤ºã•ã‚Œã€çµ‚äº†æ™‚åˆ»ãŒä¸æ˜
- **åŸå› **: çµ‚äº†æ™‚åˆ»è¨ˆç®—æ©Ÿèƒ½ãŒæœªå®Ÿè£…
- **å½±éŸ¿**: ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨ä½“ã®æ™‚é–“ç®¡ç†ãŒå›°é›£

## ğŸ”§ ä¿®æ­£ä½œæ¥­ã®è©³ç´°

### Phase 1: åˆæœŸèª¿æŸ»ã¨å•é¡Œåˆ†æ

#### ccusageå‡ºåŠ›ã®èª¿æŸ»
```bash
# é€šå¸¸ã®blockså‡ºåŠ›
npx ccusage@latest blocks
# çµæœ:
# 7/9/2025, 1:00:00 AM (2h 19m elapsed, 2h 41m remaining)
# Models: opus-4, sonnet-4
# Tokens: 7,838,142
# Cost: $4.88

# Live Viewå‡ºåŠ›
npx ccusage@latest blocks --live
# çµæœ:
# Started: 01:00:00 AM
# Remaining: 2h (06:00:00 AM)
# Tokens: 55,549 (Burn Rate: 59017 token/min)
# Models: opus-4, sonnet-4
```

#### æ™‚åˆ»å¤‰æ›ãƒ†ã‚¹ãƒˆ
```javascript
// UTC â†’ JSTå¤‰æ›ãƒ†ã‚¹ãƒˆ
function convertToJST(utcTimeString) {
    // UTC 01:00:00 AM â†’ JST 10:00:00 AM
    // UTC 06:00:00 AM â†’ JST 03:00:00 PM
}
```

### Phase 2: ãƒ—ãƒ©ãƒ³æ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯ã®æ”¹å–„

#### ä¿®æ­£å‰ã®ã‚³ãƒ¼ãƒ‰
```typescript
// å˜ç´”ãªæ–‡å­—åˆ—æ¤œç´¢ï¼ˆä¸æ­£ç¢ºï¼‰
const isPro = output.toLowerCase().includes('pro');
const isMax = output.toLowerCase().includes('max');
```

#### ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰
```typescript
// ã‚»ãƒƒã‚·ãƒ§ãƒ³ç‰¹æ€§ã«ã‚ˆã‚‹åˆ¤å®šï¼ˆæ­£ç¢ºï¼‰
const hasSessionLimit = output.includes('remaining') || output.includes('Remaining');
const hasOpusModel = output.includes('opus-4');

// MAXãƒ—ãƒ©ãƒ³: opus-4ãƒ¢ãƒ‡ãƒ« + ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶é™
const isMax = hasOpusModel && hasSessionLimit;
// Proãƒ—ãƒ©ãƒ³: ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶é™ + opus-4ãªã—
const isPro = hasSessionLimit && !hasOpusModel;
```

#### åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã®æ ¹æ‹ 
- **MAXãƒ—ãƒ©ãƒ³**: Opus-4ãƒ¢ãƒ‡ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨© + 5æ™‚é–“ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶é™
- **Proãƒ—ãƒ©ãƒ³**: Sonnet-4/Haiku-4ã®ã¿ + ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶é™
- **Freeãƒ—ãƒ©ãƒ³**: ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶é™ãªã—

### Phase 3: æ™‚åˆ»è§£æã¨æ—¥æœ¬æ™‚é–“å¤‰æ›

#### UTCâ†’JSTå¤‰æ›æ©Ÿèƒ½ã®å®Ÿè£…
```typescript
function convertToJST(utcTimeString: string): string {
    try {
        // UTCæ™‚åˆ»æ–‡å­—åˆ—ã‚’è§£æ "01:00:00 AM"
        const today = new Date();
        const [time, ampm] = utcTimeString.split(' ');
        const [hours, minutes, seconds] = time.split(':').map(Number);
        
        // 12æ™‚é–“å½¢å¼ã‚’24æ™‚é–“å½¢å¼ã«å¤‰æ›
        let hour24 = hours;
        if (ampm === 'PM' && hours !== 12) {
            hour24 += 12;
        } else if (ampm === 'AM' && hours === 12) {
            hour24 = 0;
        }
        
        // UTCæ—¥æ™‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
        const utcDate = new Date(today.getFullYear(), today.getMonth(), today.getDate(), hour24, minutes, seconds);
        
        // JSTï¼ˆUTC+9ï¼‰ã«å¤‰æ›
        const jstDate = new Date(utcDate.getTime() + (9 * 60 * 60 * 1000));
        
        // æ—¥æœ¬æ™‚é–“ã®12æ™‚é–“å½¢å¼ã§å‡ºåŠ›
        const jstHour = jstDate.getHours();
        const jstMinute = jstDate.getMinutes();
        const jstSecond = jstDate.getSeconds();
        
        const jstHour12 = jstHour === 0 ? 12 : jstHour > 12 ? jstHour - 12 : jstHour;
        const jstAmPm = jstHour < 12 ? 'AM' : 'PM';
        
        return `${jstHour12.toString().padStart(2, '0')}:${jstMinute.toString().padStart(2, '0')}:${jstSecond.toString().padStart(2, '0')} ${jstAmPm}`;
    } catch (error) {
        // å¤‰æ›å¤±æ•—æ™‚ã¯å…ƒã®æ–‡å­—åˆ—ã‚’è¿”ã™
        return utcTimeString;
    }
}
```

#### å¤‰æ›ãƒ†ã‚¹ãƒˆçµæœ
```
UTC 01:00:00 AM â†’ JST 10:00:00 AM
UTC 06:00:00 AM â†’ JST 03:00:00 PM
Current time: 2025/7/9 12:17:19 (JST)
```

### Phase 4: ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚åˆ»è¨ˆç®—æ©Ÿèƒ½

#### çµ‚äº†æ™‚åˆ»è¨ˆç®—ã®å®Ÿè£…
```typescript
function calculateSessionEnd(startTimeJST: string, remainingTime: string): string {
    try {
        // é–‹å§‹æ™‚åˆ»ã‚’è§£æ
        const [time, ampm] = startTimeJST.split(' ');
        const [hours, minutes, seconds] = time.split(':').map(Number);
        
        // 24æ™‚é–“å½¢å¼ã«å¤‰æ›
        let hour24 = hours;
        if (ampm === 'PM' && hours !== 12) {
            hour24 += 12;
        } else if (ampm === 'AM' && hours === 12) {
            hour24 = 0;
        }
        
        // é–‹å§‹æ™‚åˆ»ã®Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
        const today = new Date();
        const startDate = new Date(today.getFullYear(), today.getMonth(), today.getDate(), hour24, minutes, seconds);
        
        // æ®‹ã‚Šæ™‚é–“ã‚’è§£æ "2h 41m"
        const hoursMatch = remainingTime.match(/(\d+)h/);
        const minutesMatch = remainingTime.match(/(\d+)m/);
        
        const remainingHours = hoursMatch ? parseInt(hoursMatch[1]) : 0;
        const remainingMinutes = minutesMatch ? parseInt(minutesMatch[1]) : 0;
        
        // çµ‚äº†æ™‚åˆ»ã‚’è¨ˆç®—
        const endDate = new Date(startDate.getTime() + (remainingHours * 60 * 60 * 1000) + (remainingMinutes * 60 * 1000));
        
        // 12æ™‚é–“å½¢å¼ã§å‡ºåŠ›
        const endHour = endDate.getHours();
        const endMinute = endDate.getMinutes();
        const endSecond = endDate.getSeconds();
        
        const endHour12 = endHour === 0 ? 12 : endHour > 12 ? endHour - 12 : endHour;
        const endAmPm = endHour < 12 ? 'AM' : 'PM';
        
        return `${endHour12.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}:${endSecond.toString().padStart(2, '0')} ${endAmPm}`;
    } catch (error) {
        return 'Unknown';
    }
}
```

### Phase 5: å‡ºåŠ›è§£æãƒ­ã‚¸ãƒƒã‚¯ã®æ”¹å–„

#### blockså½¢å¼å‡ºåŠ›ã®è§£æ
```typescript
// blockså½¢å¼: "7/9/2025, 1:00:00 AM (2h 19m elapsed, 2h 41m remaining)"
const sessionStartMatch = output.match(/(\d{1,2}\/\d{1,2}\/\d{4}, \d{1,2}:\d{2}:\d{2} [AP]M)/);
if (sessionStartMatch) {
    const fullUtcTime = sessionStartMatch[1];
    const timeOnly = fullUtcTime.split(', ')[1]; // "1:00:00 AM"ã‚’æŠ½å‡º
    sessionStart = convertToJST(timeOnly);
    console.log(`[Claude Code Status] Session Start - UTC: ${timeOnly}, JST: ${sessionStart}`);
}

// æ®‹ã‚Šæ™‚é–“ã®è§£æ
const remainingMatch = output.match(/(\d+h \d+m|\d+h|\d+m) remaining/);
if (remainingMatch && sessionStart) {
    const remainingTime = remainingMatch[1];
    sessionEnd = calculateSessionEnd(sessionStart, remainingTime);
    console.log(`[Claude Code Status] Session End calculated - JST: ${sessionEnd}`);
}
```

#### Live Viewå½¢å¼å‡ºåŠ›ã®è§£æï¼ˆå‚è€ƒï¼‰
```typescript
// Live Viewå½¢å¼: "Started: 01:00:00 AM" "Remaining: 2h (06:00:00 AM)"
const sessionStartMatch = output.match(/Started: (\d{1,2}:\d{2}:\d{2} [AP]M)/);
const sessionEndMatch = output.match(/Remaining: \d+h(?: \d+m)? \((\d{1,2}:\d{2}:\d{2} [AP]M)\)/);
```

### Phase 6: ãƒˆãƒ¼ã‚¯ãƒ³æ•°ãƒ»ã‚³ã‚¹ãƒˆè§£æã®æ”¹å–„

#### ç¾åœ¨ä½¿ç”¨é‡ã®å–å¾—
```typescript
// blockså½¢å¼: "Tokens: 7,838,142" "Cost: $4.88"
const liveTokensMatch = output.match(/Tokens: ([\d,]+) \(Burn Rate:/);
if (liveTokensMatch) {
    tokens = parseInt(liveTokensMatch[1].replace(/,/g, ''));
} else {
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    const tokensMatch = output.match(/Tokens: ([\d,]+)/);
    if (tokensMatch) {
        tokens = parseInt(tokensMatch[1].replace(/,/g, ''));
    }
}

// ã‚³ã‚¹ãƒˆè§£æ
const costMatch = output.match(/Cost: \$?([\d.]+)/);
if (costMatch) {
    cost = parseFloat(costMatch[1]);
}
```

#### ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²æ—è¨ˆç®—
```typescript
// çµŒéæ™‚é–“ã‹ã‚‰é€²æ—ç‡ã‚’è¨ˆç®—
const progressMatch = output.match(/(\d+\.?\d*)%/);
if (progressMatch) {
    sessionProgress = parseFloat(progressMatch[1]);
}
```

### Phase 7: ãƒ¢ãƒ‡ãƒ«æ¤œå‡ºã®æ”¹å–„

#### ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«ã®ç‰¹å®š
```typescript
// blockså½¢å¼: "âš™ï¸  Models: opus-4, sonnet-4"
const modelMatch = output.match(/âš™ï¸\s+Models: (.+)/);
if (modelMatch) {
    model = modelMatch[1].trim();
} else {
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    const altModelMatch = output.match(/Models: (.+)/);
    if (altModelMatch) {
        model = altModelMatch[1].trim();
    } else {
        // å€‹åˆ¥æ¤œå‡º
        if (output.includes('opus-4')) {
            model = 'opus-4';
        } else if (output.includes('sonnet-4')) {
            model = 'sonnet-4';
        } else if (output.includes('haiku-4')) {
            model = 'haiku-4';
        }
    }
}
```

### Phase 8: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼è¡¨ç¤ºã®æ”¹å–„

#### è¡¨ç¤ºå†…å®¹ã®æ§‹æˆ
```typescript
let statusText = '';

// ãƒ—ãƒ©ãƒ³è¡¨ç¤º
if (usageData.isMax) {
    statusText = '$(zap) MAX ';
} else if (usageData.isPro) {
    statusText = '$(star) Pro ';
} else {
    statusText = '$(cloud) ';
}

// ãƒ¢ãƒ‡ãƒ«è¡¨ç¤º
statusText += `${usageData.model} `;

// ãƒˆãƒ¼ã‚¯ãƒ³æ•°è¡¨ç¤º
statusText += `$(arrow-right) ${formatTokens(usageData.tokens)} `;

// ã‚³ã‚¹ãƒˆè¡¨ç¤º
if (showCurrency === 'JPY') {
    const jpyCost = usageData.cost * jpyRate;
    statusText += `$(credit-card) Â¥${jpyCost.toFixed(0)} `;
} else {
    statusText += `$(credit-card) $${usageData.cost.toFixed(2)} `;
}

// ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²æ—è¡¨ç¤º
if (usageData.sessionProgress) {
    statusText += `$(clock) ${usageData.sessionProgress.toFixed(1)}% `;
}

// æ®‹ã‚Šæ™‚é–“è¡¨ç¤º
if (showTimeRemaining && usageData.timeRemaining) {
    statusText += `$(watch) ${usageData.timeRemaining}`;
}

// ã‚¢ã‚¯ãƒ†ã‚£ãƒ–è¡¨ç¤º
if (usageData.isActive) {
    statusText += ' $(pulse)';
}
```

#### ãƒˆãƒ¼ã‚¯ãƒ³æ•°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
```typescript
function formatTokens(tokens: number): string {
    if (tokens >= 1000000000) {
        return `${(tokens / 1000000000).toFixed(1)}B`;
    } else if (tokens >= 1000000) {
        return `${(tokens / 1000000).toFixed(1)}M`;
    } else if (tokens >= 1000) {
        return `${(tokens / 1000).toFixed(1)}K`;
    }
    return tokens.toString();
}
```

### Phase 9: ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã®æ‹¡å¼µ

#### è©³ç´°æƒ…å ±ã®è¡¨ç¤º
```typescript
function createTooltip(data: UsageData, currency: string, jpyRate: number): string {
    let tooltip = `Claude Code Usage Stats\n`;
    tooltip += `â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n`;
    tooltip += `Model: ${data.model}\n`;
    tooltip += `Tokens: ${formatTokens(data.tokens)}\n`;
    
    if (currency === 'JPY') {
        tooltip += `Cost: Â¥${(data.cost * jpyRate).toFixed(0)}\n`;
        tooltip += `(Rate: $1 = Â¥${jpyRate})\n`;
    } else {
        tooltip += `Cost: $${data.cost.toFixed(2)}\n`;
    }
    
    if (data.sessionStart) {
        tooltip += `Session Start: ${data.sessionStart}\n`;
    }
    
    if (data.sessionEnd) {
        tooltip += `Session End: ${data.sessionEnd}\n`;
    }
    
    if (data.sessionProgress) {
        tooltip += `Session Progress: ${data.sessionProgress.toFixed(1)}%\n`;
    }
    
    if (data.timeRemaining) {
        tooltip += `Time Remaining: ${data.timeRemaining}\n`;
    }
    
    if (data.burnRate) {
        tooltip += `Burn Rate: ${data.burnRate.toLocaleString()} tokens/min\n`;
    }
    
    if (data.projectedTokens) {
        tooltip += `Projected Tokens: ${formatTokens(data.projectedTokens)}\n`;
    }
    
    if (data.projectedCost) {
        if (currency === 'JPY') {
            tooltip += `Projected Cost: Â¥${(data.projectedCost * jpyRate).toFixed(0)}\n`;
        } else {
            tooltip += `Projected Cost: $${data.projectedCost.toFixed(2)}\n`;
        }
    }
    
    tooltip += `â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n`;
    
    if (data.isPro) {
        tooltip += `Plan: Pro\n`;
    } else if (data.isMax) {
        tooltip += `Plan: MAX\n`;
    }
    
    if (data.isActive) {
        tooltip += `Status: Active Session\n`;
    }
    
    tooltip += `\nClick to open live view`;
    tooltip += `\nRight-click â†’ Refresh to update`;
    
    return tooltip;
}
```

### Phase 10: ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ã®è¿½åŠ 

#### ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã®å®Ÿè£…
```typescript
// ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚åˆ»ã®ãƒ­ã‚°
if (sessionStartMatch) {
    const utcTime = sessionStartMatch[1];
    sessionStart = convertToJST(utcTime);
    console.log(`[Claude Code Status] Session Start - UTC: ${utcTime}, JST: ${sessionStart}`);
}

// ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚åˆ»ã®ãƒ­ã‚°
if (remainingMatch && sessionStart) {
    const remainingTime = remainingMatch[1];
    sessionEnd = calculateSessionEnd(sessionStart, remainingTime);
    console.log(`[Claude Code Status] Session End calculated - JST: ${sessionEnd}`);
}
```

#### æ›´æ–°é–“éš”ã®èª¿æ•´
```typescript
// æ›´æ–°é–“éš”ã‚’5ç§’ã«çŸ­ç¸®
const interval = config.get<number>('interval', 5000);
```

### Phase 11: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

#### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°æ‰‹é †
```bash
# TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
npm run compile

# VSIXãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ
vsce package

# æ—¢å­˜æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
code --uninstall-extension undefined_publisher.claude-code-status

# æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
code --install-extension claude-code-status-0.2.0.vsix
```

#### package.jsonã®æ›´æ–°
```json
{
  "name": "claude-code-status",
  "displayName": "Claude Code Status",
  "description": "Shows Claude Code usage stats and costs in the status bar",
  "version": "0.2.0",
  "engines": {
    "vscode": "^1.74.0"
  },
  "categories": ["Other"],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "configuration": {
      "title": "Claude Code Status",
      "properties": {
        "claudeCodeStatus.enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable/disable the Claude Code Status extension"
        },
        "claudeCodeStatus.interval": {
          "type": "number",
          "default": 5000,
          "description": "Update interval in milliseconds (default: 5000)"
        },
        "claudeCodeStatus.showCurrency": {
          "type": "string",
          "default": "USD",
          "enum": ["USD", "JPY"],
          "description": "Currency to display costs in"
        },
        "claudeCodeStatus.jpyRate": {
          "type": "number",
          "default": 150,
          "description": "USD to JPY exchange rate"
        },
        "claudeCodeStatus.command": {
          "type": "string",
          "default": "npx ccusage@latest blocks",
          "description": "Command to execute for getting usage stats"
        },
        "claudeCodeStatus.showTimeRemaining": {
          "type": "boolean",
          "default": true,
          "description": "Show time remaining for Pro/MAX plans"
        }
      }
    }
  }
}
```

## ğŸ“Š å®Ÿè£…çµæœã®è©³ç´°

### ä¿®æ­£å‰ã®è¡¨ç¤ºçŠ¶æ…‹
```
Status Bar: $(star) Pro sonnet-4 â†’ 4.73M $3.33 $(clock) 40.5% $(watch) 3h 2m
Tooltip:
- Model: sonnet-4
- Tokens: 4,733,921
- Cost: $3.33
- Session Progress: 40.5%
- Time Remaining: 3h 2m
- Plan: Pro (èª¤ã‚Š)
- Status: Active Session
```

### ä¿®æ­£å¾Œã®è¡¨ç¤ºçŠ¶æ…‹
```
Status Bar: $(zap) MAX opus-4, sonnet-4 â†’ 7.84M $4.88 $(clock) 46.3% $(watch) 2h 41m $(pulse)
Tooltip:
- Model: opus-4, sonnet-4
- Tokens: 7.84M
- Cost: $4.88
- Session Start: 10:00:00 AM (JST)
- Session End: 03:00:00 PM (JST)
- Session Progress: 46.3%
- Time Remaining: 2h 41m
- Burn Rate: 59,017 tokens/min
- Projected Tokens: 18.34M
- Projected Cost: $11.43
- Plan: MAX (æ­£ç¢º)
- Status: Active Session
```

### æ™‚åˆ»å¤‰æ›ã®æ¤œè¨¼
```
System Time: Wed Jul 9 03:13:09 AM UTC 2025
Japan Time: 2025/7/9 12:13:19 JST

ccusage Output:
- UTC Start: 01:00:00 AM
- UTC End: 06:00:00 AM

Extension Display:
- JST Start: 10:00:00 AM
- JST End: 03:00:00 PM
- Current: 12:13 PM JST (æ­£ç¢º)
```

## ğŸ” æŠ€è¡“çš„è©³ç´°

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
1. **Data Collection**: `npx ccusage@latest blocks` å®Ÿè¡Œ
2. **Output Parsing**: æ­£è¦è¡¨ç¾ã«ã‚ˆã‚‹å„ç¨®ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
3. **Time Conversion**: UTC â†’ JSTå¤‰æ›
4. **Plan Detection**: ãƒ¢ãƒ‡ãƒ«ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ç‰¹æ€§ã«ã‚ˆã‚‹åˆ¤å®š
5. **Display Formatting**: VS Codeç”¨ã‚¢ã‚¤ã‚³ãƒ³ã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
6. **Status Update**: 5ç§’é–“éš”ã§ã®è‡ªå‹•æ›´æ–°

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```typescript
// æ™‚åˆ»å¤‰æ›ã‚¨ãƒ©ãƒ¼
try {
    sessionStart = convertToJST(timeOnly);
} catch (error) {
    console.error('Time conversion error:', error);
    sessionStart = timeOnly; // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
}

// ccusageå®Ÿè¡Œã‚¨ãƒ©ãƒ¼
try {
    const { stdout } = await execAsync(command, { timeout: 10000 });
    const usageData = parseUsageData(stdout);
} catch (error) {
    console.error('Error fetching usage:', error);
    statusBarItem.text = '$(error) Error fetching usage';
    statusBarItem.backgroundColor = new vscode.ThemeColor('statusBarItem.errorBackground');
}
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- 5ç§’é–“éš”ã§ã®æ›´æ–°ï¼ˆéåº¦ãªè² è·ã‚’é¿ã‘ã‚‹ï¼‰
- 10ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
- ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
- åŠ¹ç‡çš„ãªæ­£è¦è¡¨ç¾ãƒãƒƒãƒãƒ³ã‚°

## ğŸ§ª ãƒ†ã‚¹ãƒˆçµæœ

### æ™‚åˆ»å¤‰æ›ãƒ†ã‚¹ãƒˆ
```javascript
// test_jst.js
console.log('UTC 01:00:00 AM -> JST:', convertToJST('01:00:00 AM'));
console.log('UTC 06:00:00 AM -> JST:', convertToJST('06:00:00 AM'));
console.log('Current time:', new Date().toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }));

// çµæœ:
// UTC 01:00:00 AM -> JST: 10:00:00 AM
// UTC 06:00:00 AM -> JST: 03:00:00 PM
// Current time: 2025/7/9 12:17:19
```

### ãƒ—ãƒ©ãƒ³æ¤œå‡ºãƒ†ã‚¹ãƒˆ
```
Test Case 1: MAX Plan
Input: "7/9/2025, 1:00:00 AM (2h 41m remaining) - opus-4"
Expected: isMax = true, isPro = false
Result: âœ… PASS

Test Case 2: Pro Plan
Input: "7/9/2025, 1:00:00 AM (2h 41m remaining) - sonnet-4"
Expected: isMax = false, isPro = true
Result: âœ… PASS

Test Case 3: Free Plan
Input: "7/9/2025, 1:00:00 AM - sonnet-4"
Expected: isMax = false, isPro = false
Result: âœ… PASS
```

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ãƒ†ã‚¹ãƒˆ
```
12:17:19 - Session Start: 10:00:00 AM, End: 03:00:00 PM, Progress: 46.3%
12:17:24 - Session Start: 10:00:00 AM, End: 03:00:00 PM, Progress: 46.3%
12:17:29 - Session Start: 10:00:00 AM, End: 03:00:00 PM, Progress: 46.4%
```

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«
```
/workspaces/Research/ccusage-vscode-extension/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ extension.ts              # ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ (502è¡Œ)
â”œâ”€â”€ out/
â”‚   â””â”€â”€ extension.js              # ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿JS
â”œâ”€â”€ package.json                  # æ‹¡å¼µæ©Ÿèƒ½è¨­å®š
â”œâ”€â”€ tsconfig.json                 # TypeScriptè¨­å®š
â”œâ”€â”€ claude-code-status-0.2.0.vsix # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ test_jst.js                   # ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

### extension.ts ã®æ§‹é€ 
```typescript
// ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
interface UsageData {
    model: string;
    tokens: number;
    cost: number;
    dailyCost: number;
    timeRemaining?: string;
    sessionProgress?: number;
    projectedTokens?: number;
    projectedCost?: number;
    burnRate?: number;
    isPro?: boolean;
    isMax?: boolean;
    isActive?: boolean;
    sessionStart?: string;
    sessionEnd?: string;
}

// ãƒ¡ã‚¤ãƒ³é–¢æ•°
export function activate(context: vscode.ExtensionContext) {
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ä½œæˆ
    // æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
    // ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
}

// ãƒ‡ãƒ¼ã‚¿è§£æé–¢æ•°
function parseUsageData(output: string): UsageData | null {
    // æ™‚åˆ»è§£æ
    // ãƒˆãƒ¼ã‚¯ãƒ³æ•°è§£æ
    // ã‚³ã‚¹ãƒˆè§£æ
    // ãƒ—ãƒ©ãƒ³åˆ¤å®š
    // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è¨ˆç®—
}

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
function convertToJST(utcTimeString: string): string
function calculateSessionEnd(startTimeJST: string, remainingTime: string): string
function formatTokens(tokens: number): string
function createTooltip(data: UsageData, currency: string, jpyRate: number): string
```

## ğŸ¯ æœ€çµ‚çš„ãªå®Ÿè£…æˆæœ

### 1. æ­£ç¢ºãªãƒ—ãƒ©ãƒ³è¡¨ç¤º
- **MAXãƒ—ãƒ©ãƒ³**: âš¡ MAX (Lightning bolt icon)
- **Proãƒ—ãƒ©ãƒ³**: â­ Pro (Star icon)
- **Freeãƒ—ãƒ©ãƒ³**: â˜ï¸ (Cloud icon)

### 2. å®Œå…¨ãªæ™‚åˆ»æƒ…å ±
- **é–‹å§‹æ™‚åˆ»**: 10:00:00 AM JST
- **çµ‚äº†æ™‚åˆ»**: 03:00:00 PM JST
- **æ®‹ã‚Šæ™‚é–“**: 2h 41m
- **é€²æ—ç‡**: 46.3%

### 3. è©³ç´°ãªä½¿ç”¨çŠ¶æ³
- **ãƒ¢ãƒ‡ãƒ«**: opus-4, sonnet-4
- **ãƒˆãƒ¼ã‚¯ãƒ³æ•°**: 7.84M (ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿)
- **ã‚³ã‚¹ãƒˆ**: $4.88
- **Burn Rate**: 59,017 tokens/min
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³**: 18.34M tokens, $11.43

### 4. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
- **æ›´æ–°é–“éš”**: 5ç§’
- **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ**: 10ç§’
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å®Œå…¨å¯¾å¿œ
- **ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°**: è©³ç´°å‡ºåŠ›

### 5. ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£
- **è¦–è¦šçš„ã‚¢ã‚¤ã‚³ãƒ³**: VS Codeæ¨™æº–ã‚¢ã‚¤ã‚³ãƒ³ä½¿ç”¨
- **æƒ…å ±å¯†åº¦**: æœ€é©åŒ–ã•ã‚ŒãŸã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤º
- **è©³ç´°æƒ…å ±**: ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã§æ‹¡å¼µæƒ…å ±
- **è¨­å®šå¯èƒ½**: é€šè²¨ã€æ›´æ–°é–“éš”ã€è¡¨ç¤ºé …ç›®

## ğŸ”® ä»Šå¾Œã®æ‹¡å¼µå¯èƒ½æ€§

### çŸ­æœŸçš„æ”¹å–„
1. **è¨­å®šç”»é¢**: GUIè¨­å®šãƒ‘ãƒãƒ«
2. **é€šçŸ¥æ©Ÿèƒ½**: ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†ã‚¢ãƒ©ãƒ¼ãƒˆ
3. **å±¥æ­´æ©Ÿèƒ½**: ä½¿ç”¨é‡å±¥æ­´ã®è¨˜éŒ²
4. **ãƒ†ãƒ¼ãƒå¯¾å¿œ**: VS Codeãƒ†ãƒ¼ãƒã¨ã®çµ±åˆ

### ä¸­æœŸçš„æ”¹å–„
1. **çµ±è¨ˆåˆ†æ**: ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æ
2. **ã‚³ã‚¹ãƒˆäºˆæ¸¬**: ä½¿ç”¨é‡äºˆæ¸¬æ©Ÿèƒ½
3. **ãƒãƒ«ãƒã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**: è¤‡æ•°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¯¾å¿œ
4. **ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**: ãƒ‡ãƒ¼ã‚¿ã®CSVå‡ºåŠ›

### é•·æœŸçš„æ”¹å–„
1. **AIçµ±åˆ**: ä½¿ç”¨é‡æœ€é©åŒ–ææ¡ˆ
2. **ãƒãƒ¼ãƒ æ©Ÿèƒ½**: ãƒãƒ¼ãƒ ä½¿ç”¨é‡ç®¡ç†
3. **APIé€£æº**: Claude APIç›´æ¥çµ±åˆ
4. **ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸ**: è¨­å®šã®åŒæœŸæ©Ÿèƒ½

## ğŸ“‹ ä»Šå›ã®ä½œæ¥­ã§å­¦ã‚“ã ã“ã¨

### æŠ€è¡“çš„çŸ¥è¦‹
1. **VS Codeæ‹¡å¼µé–‹ç™º**: TypeScriptã€package.jsonã€vsce
2. **æ™‚åˆ»å‡¦ç†**: ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›ã€Date ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
3. **æ­£è¦è¡¨ç¾**: è¤‡é›‘ãªå‡ºåŠ›è§£æ
4. **éåŒæœŸå‡¦ç†**: execAsyncã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
5. **UI/UX**: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã€ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã€ã‚¢ã‚¤ã‚³ãƒ³

### é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹
1. **å•é¡Œåˆ†æ**: æ ¹æœ¬åŸå› ã®ç‰¹å®š
2. **æ®µéšçš„å®Ÿè£…**: ãƒ•ã‚§ãƒ¼ã‚ºåˆ†ã‘ã«ã‚ˆã‚‹é–‹ç™º
3. **ãƒ†ã‚¹ãƒˆé§†å‹•**: å„æ©Ÿèƒ½ã®å˜ä½“ãƒ†ã‚¹ãƒˆ
4. **ãƒ‡ãƒãƒƒã‚°**: ãƒ­ã‚°å‡ºåŠ›ã«ã‚ˆã‚‹å•é¡Œè¿½è·¡
5. **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**: å®Ÿéš›ã®ä½¿ç”¨ã‚·ãƒŠãƒªã‚ªè€ƒæ…®

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
1. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: æ©Ÿèƒ½å˜ä½ã§ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°
2. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: è©³ç´°ãªå¤‰æ›´è¨˜éŒ²
3. **å“è³ªä¿è¨¼**: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
4. **ç¶™ç¶šçš„æ”¹å–„**: æ®µéšçš„ãªæ©Ÿèƒ½è¿½åŠ 

## ğŸ‰ å®Œäº†æ™‚ã®çŠ¶æ…‹

### æœ€çµ‚çš„ãªæ‹¡å¼µæ©Ÿèƒ½ã®è¡¨ç¤º
```
VS Code Status Bar:
âš¡ MAX opus-4, sonnet-4 â†’ 7.84M $4.88 â±ï¸ 46.3% âŒš 2h 41m ğŸ”„

Detailed Tooltip:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Model: opus-4, sonnet-4
Tokens: 7.84M
Cost: $4.88
Session Start: 10:00:00 AM
Session End: 03:00:00 PM
Session Progress: 46.3%
Time Remaining: 2h 41m
Burn Rate: 59,017 tokens/min
Projected Tokens: 18.34M
Projected Cost: $11.43
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Plan: MAX
Status: Active Session

Click to open live view
Right-click â†’ Refresh to update
```

### æŠ€è¡“ä»•æ§˜
- **è¨€èª**: TypeScript 4.9.4
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: VS Code Extension API
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.2.0
- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚µã‚¤ã‚º**: 8.55KB
- **ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 7
- **æ›´æ–°é–“éš”**: 5ç§’
- **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ**: 10ç§’

### å‹•ä½œç¢ºèª
- âœ… MAXãƒ—ãƒ©ãƒ³è¡¨ç¤ºã®æ­£ç¢ºæ€§
- âœ… æ—¥æœ¬æ™‚é–“å¤‰æ›ã®æ­£ç¢ºæ€§
- âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚åˆ»ã®è¡¨ç¤º
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- âœ… ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—æƒ…å ±
- âœ… è¨­å®šã®åæ˜ 

---

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†æ—¥æ™‚**: 2025å¹´7æœˆ9æ—¥ 12:20 PM JST  
**ä½œæ¥­æ™‚é–“**: ç´„2æ™‚é–“  
**æœ€çµ‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: claude-code-status-0.2.0.vsix  
**ä½œæ¥­è€…**: Claude Code Assistant  
**è¨˜éŒ²è€…**: Claude Code Assistant  
**ä¿å­˜å ´æ‰€**: `/workspaces/Research/03_ç ”ç©¶è³‡æ–™/æ—¥æ¬¡ä½œæ¥­è¨˜éŒ²/`